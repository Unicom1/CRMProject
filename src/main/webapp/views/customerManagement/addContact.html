<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>客户关系管理系统</title>
    <link rel="stylesheet" href="../../css/bootstrap/css/bootstrap.min.css" >
    <!--<link href="../js/AdminLTE/css/AdminLTE.min.css" rel="stylesheet">-->
    <!--<link href="../js/AdminLTE/css/skins/_all-skins.min.css" rel="stylesheet">-->
    <link rel="stylesheet" href="../../css/index.css">
    <link rel="stylesheet" href="../../css/left_menu.css">
    <link href="../../css/jquery.city.css" rel="stylesheet" />
    <link href="../../js/address/css/animate.min.css" rel="stylesheet" />
    <script src="../../js/jquery-3.2.1.js"></script>
    <!--<script src="../js/AdminLTE/js/app.min.js"></script>-->
    <script src="../../js/bootstrap.js"></script>
    <script src="../../js/bootstrap.min.js"></script>
    <script src="../../js/layer/layer.js"></script>
    <script src="../../js/address/js/jquery.city.js"></script>
    <style>
        #userMenu{
            margin-left:10px;
        }
        #userMenu li{
            float:left;
            list-style:none;
            height:60px;
            width:150px;
            padding-top:10px;
            text-align:center;
            font-size:22px;
            border-bottom:2px solid #ffb173;
        }
        a:hover{
            text-decoration:none;
        }

        table thead tr th{
            text-align:center;
        }
        .control-label{
            font-weight:400;
            font-size:16px;
        }
        .city-content{
            width:350px;
        }
    </style>
</head>
<body>
<div class="wrapper">
    <div class="wmenu">
        <dl ><dt class="user"><a href="#" style="margin-left:15px;">首页</a></dt></dl>
        <dl ><dt class="edit"><a href="#">用户管理</a></dt></dl>
        <dl style="background-color:#bdd7ee"><dt class="edit"><a href="#">客户管理</a></dt></dl>
        <dl><dt class="edit"><a href="#">商机管理</a></dt></dl>
        <dl><dt class="edit"><a href="#">产品管理</a></dt></dl>
        <dl><dt class="edit"><a href="#">合同管理</a></dt></dl>
        <dl><dt class="edit"><a href="#">财务管理</a></dt></dl>
        <dl><dt class="edit"><a href="#">数据分析管理</a></dt></dl>
        <dl><dt class="edit"><a href="#">办公管理</a></dt></dl>
    </div>
    <div style="float:right;margin-right:50px;margin-top:20px;font-size:15px;"><a href="">退出系统</a></div>
    <div class="content" style="margin-left:170px;">
        <div>
            <ul id="userMenu">
                <li style="border:none;"><a href="javascript:void(0)" style="color:grey;" onclick="">客户列表</a></li>
                <li ><a href="javascript:void(0)" onclick="" >客户联系人</a></li>
            </ul>
        </div>
        <div style="height:70px;"></div>
        <div  class="row" style="width:95%;height:500px;margin-left:2.5%;">
            <form role="form" id="addCustomerForm">

                <div class="form-group" style="background-color:#ffffff;width:70%;height:500px;overflow-y:auto;">
                    <div class="header" style="font-weight:500;font-size:19px;padding:5px 0 10px 15px;" >
                        <span class="glyphicon glyphicon-user"></span><span>基本信息</span>
                    </div>
                    <div class="col-sm-offset-1">
                    <div class="form-group col-sm-12">
                        <label class="col-sm-3 control-label" >联系人姓名</label>
                        <div class="col-sm-7">
                            <input type="text"  class="form-control" id="contact_name"
                                   placeholder="请输入联系人姓名" value="" required>
                        </div>
                        <div class="col-sm-2">
                            <span class="glyphicon glyphicon-asterisk" style="color: orangered;position:relative;top:20px;right:25px;"></span>
                        </div>
                        <!--<div class="col-sm-offset-3 col-sm-7" style="color:lightgray">如有联系人信息，则联系人姓名不能为空</div>-->
                    </div>
                    <div class="form-group col-sm-12">
                        <label class="col-sm-3 control-label" >角色</label>
                        <div class="col-sm-7">
                            <select class="form-control" id="contact_role">
                                <!--<option>请选择</option>-->
                                <option>普通人</option>
                                <option>决策人</option>
                                <option>分项决策人</option>
                                <option>商务决策</option>
                                <option>技术决策</option>
                                <option>财务决策</option>
                                <option>使用人</option>
                                <option>意见影响人</option>
                            </select>
                        </div>
                        <!--<div class="col-sm-2">-->
                        <!--<span class="glyphicon glyphicon-asterisk" style="color: orangered;position:relative;top:20px;right:25px;"></span>-->
                        <!--</div>-->
                    </div>
                    <div class="form-group col-sm-12">
                        <label class="col-sm-3 control-label" >尊称</label>
                        <div class="col-sm-7" style="padding-top:5px;">
                            <label><input type="radio" name="contact_sex"   value="0" checked="checked"/>先生</label>
                            <label><input type="radio" name="contact_sex"   style="margin-left:30px;" value="1"/>女士</label>
                        </div>
                    </div>
                    <div class="form-group col-sm-12">
                        <label class="col-sm-3 control-label" >职位</label>
                        <div class="col-sm-7">
                            <input type="text"  class="form-control" id="contact_position"
                                   placeholder="请输入职位" value="" required>
                        </div>
                    </div>
                    <div class="form-group col-sm-12">
                        <label class="col-sm-3 control-label" >手机</label>
                        <div class="col-sm-7">
                            <input type="text"  class="form-control" id="contact_phone"
                                   placeholder="请输入手机号码" value="" required>
                        </div>
                    </div>
                    <div class="form-group col-sm-12">
                        <label class="col-sm-3 control-label" >邮箱</label>
                        <div class="col-sm-7">
                            <input type="email"  class="form-control" id="contact_email"
                                   placeholder="请输入邮箱地址" value="" required>
                        </div>
                    </div>
                    <div class="form-group col-sm-12">
                        <label class="col-sm-3 control-label">地址</label>
                        <div class="col-sm-9">
                            <div  >
                                <input type="text" id="txt_city2" />
                            </div>
                        </div>
                        <div class="col-sm-7 col-sm-offset-3">
                            <input type="text"  class="form-control" id="contact_street"
                                   placeholder="请输入街道信息" value="" >
                        </div>
                    </div>
                    <div class="form-group col-sm-12">
                        <label class="col-sm-3 control-label">备注信息</label>
                        <div class="col-sm-7">
                            <textarea type=""  class="form-control" id="contact_remark" style="height:100px;" ></textarea>
                        </div>
                    </div>
                    </div>
                </div>
            </form>
        </div>
        <div class="col-md-offset-3" style="margin-top:25px;">
            <button type="button" id="addCustomerBtn" class="btn btn-primary" onclick="addContact()">创建联系人</button>
        </div>
    </div>
</div>
<script type="text/javascript">
    $('.wmenu dl dt').click(function(){
        $(this).toggleClass('icotop');
        $(this).siblings('dd').toggleClass('hidden');
    });

    /*地址*/
    $(function () {
        $('#txt_city').jcity({
            urlOrData: '../../js/address/js/citydata.json',
            animate: { showClass: 'animated flipInX', hideClass: 'animated flipOutX' },  // 需要第一步引用的animate.min.css文件，也可以自己定义动画
            onChoice: function (data) {
                console.log(data);
            }
        });

        $('#txt_city2').jcity({
            urlOrData: '../../js/address/js/citydata.json',
            animate: { showClass: 'animated flipInX', hideClass: 'animated flipOutX' },  // 需要第一步引用的animate.min.css文件，也可以自己定义动画
            onChoice: function (data) {
                console.log(data);
            }
        });
    });

    function addContact(){
        var contact_name = $('#contact_name').val();
        var contact_role = $('#contact_role option:selected') .text();
        var contact_position = $('#contact_position') .val();
        var contact_sex = $("input[name='contact_sex']:checked").val();
        var contact_email = $('#contact_email').val();
        var contact_phone = $('#contact_phone').val();
        var contact_address = $('#txt_city2').val();
        var contact_remark = $('#contact_remark').val();

        /*拼接街道*/
        var contact_street = $('#contact_street').val();
        if(contact_street!==''){
            contact_address = contact_address +"-"+contact_street;
        }

        console.log(contact_name+","+contact_role+","+contact_sex+","+contact_position+","+contact_email+","+contact_phone+","+contact_address+","+contact_remark);

        if(contact_name==''||contact_name==null){
            layer.msg("联系人姓名不能为空！");
        }else{
            $.ajax({
                url: '/Contact/addContact',
                data: {'contact_name':contact_name,'contact_role':contact_role,'contact_position':contact_position,'contact_sex':contact_sex,
                       'contact_email':contact_email,'contact_phone':contact_phone,'contact_address':contact_address,'contact_remark':contact_remark},
                dataType: 'json',
                type: 'POST',
                success: function (res) {
                    if (res.state == 0) {
                        layer.msg("联系人已存在！");
                    } else if (res.state == 1){
                        layer.msg("新建联系人失败！");
                    }else if (res.state == 2){
                        layer.msg(res.errMsg);

                    }
                },
                error: function () {
                    layer.msg("网络连接失败！");
                }
            })
        }
    }

</script>
</body>
</html>